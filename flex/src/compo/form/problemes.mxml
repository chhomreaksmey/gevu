<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml"
		   xmlns:composants="compo.*"
		   label="Problèmes"
		   width="100%" height="100%"
 >
	
	<mx:RemoteObject id="roCrit"
					 destination="zend"
					 source="Models_DbTable_Gevu_criteres"
					 fault="faultHandlerService(event, &quot;Remote Object in problems&quot;);">
		<mx:method name="findById_critere"	result="setCritLabel( event );" />
	</mx:RemoteObject>
	
	<mx:VBox height="100%" width="100%">
	
		<mx:List height="130" width="100%" id="diaglist" change="itemClicked( event );" />
		
		<mx:Grid width="100%">
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="40%" height="100%">
					<mx:Label text="id_critere" />
				</mx:GridItem>
				<mx:GridItem width="60%" height="100%">
					<mx:Label id="F2" width="100%" />
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="40%" height="100%">
					<mx:Label text="num_marker" />
				</mx:GridItem>
				<mx:GridItem width="60%" height="100%">
					<mx:Text id="F4" width="100%" />
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="40%" height="100%">
					<mx:Label text="mesure" />
				</mx:GridItem>
				<mx:GridItem width="60%" height="100%">
					<mx:Text id="F5" width="100%" />
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="40%" height="100%">
					<mx:Label text="observations" />
				</mx:GridItem>
				<mx:GridItem width="60%" height="100%">
					<mx:Text id="F6" width="100%" />
				</mx:GridItem>
			</mx:GridRow>
		</mx:Grid>
		
	</mx:VBox>
	
	<mx:Script>
		<![CDATA[
			import mx.events.ListEvent;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			import mx.controls.Alert;
			
			[Bindable] public var NodeData : Object;
			
			public function displayNodeProperties() : void {
				var tmpdata:Array = [];
				
				
				var j:int=0;
				for(var i:String in NodeData){
					++j;
					tmpdata.push( "probleme n° "+j );
				}
				diaglist.dataProvider = tmpdata;
				displayDocProperties(0);
			}
			
			public function displayDocProperties( i:int ) : void {
				
				roCrit.findById_critere(NodeData.id_critere );
				F4.data = NodeData.num_marker;
				F5.data = NodeData.mesure;
				F6.data = NodeData.observations;
			}
			
			private function itemClicked( event:ListEvent ) : void {
				displayDocProperties( event.currentTarget.selectedIndex );
			}
			
			private function setCritLabel(event:ResultEvent):void{
				F2.data = event.result.criteres;
			}
			
			private function faultHandlerService(fault:FaultEvent, os:String=""):void {
				var str:String;
				str = "Code: "+fault.fault.faultCode.toString()+"\n"+
				      "Detail: "+fault.fault.faultDetail.toString()+"\n"+
				      "String: "+fault.fault.faultString.toString()+"\n";
				
				if (os!="")
					os = " - "+os;
				Alert.show(str, "FaultHandlerService"+os);
			}
		]]>
	</mx:Script>
</mx:Canvas>
