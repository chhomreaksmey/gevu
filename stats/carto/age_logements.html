<html>
  <head>
    <meta charset="utf-8">
    <title>Carte sur l'âge des bâtiments au Havre</title>
	<link rel="stylesheet" href="../css/colorbrewer.css" />
    <link type="text/css" rel="stylesheet" href="../css/button.css"/>
    <script type="text/javascript" src="../js/colorbrewer.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=visualization"></script>
    <script type="text/javascript" src="../js/d3.v2.js"></script>
    <script type="text/javascript" src="../js/legende_age.js"></script>    
    <link type="text/css" rel="stylesheet" href="../css/style_balise.css"/>
	<script type="text/javascript" src="../js/coors.js"></script>
    <script>
    var color, n, map, pointarray, heatmap, geocoder, adress;
	var Logements = [];

	d3.json("../donnees_tables/gevulieux.json", function(json) {
		var nb = json.children.length
		for(var i=0;i<nb;i++){
			var item = json.children[i];
			
			/*function filtrage(){
			if (item.valeur<42){
			return Logements.push(new google.maps.LatLng(item.lat, item.lng))
			}}*/
				
			Logements.push({location: new google.maps.LatLng(item.lat, item.lng), weight: item.valeur});
		}
	// Création fonction json qui prend comme valeur nb avec le total de toutes les données. On créer une boucle qui va de i = 0 jusqu'à la fin du json où l'on créer une variable item. On affiche ensuite pour chaque valeur i sa latitude et sa longitude suivant la Valeur qu'elles prennent à cet endroit.
		
        var mapOptions = {
          zoom: 11,
          center: new google.maps.LatLng(49.5493690, 0.13747540),
          mapTypeId: google.maps.MapTypeId.SATELLITE
        }; //On créer la carte avec le centre qui sont nos coordonnées et le zoom situé à 11. 
		//mapTypeId affiche des images sattelites de google Earth.

        map = new google.maps.Map(document.getElementById('map_canvas'),
            mapOptions); // On créer une variable map qui créer un div 'map_canvas' qui a un arrière plan, sa position, sa largeur, sa longueur.

        pointArray = new google.maps.MVCArray(Logements); //On créer une variable de pointArray dans lequel on prend les coordonnées de Logements.

        heatmap = new google.maps.visualization.HeatmapLayer({
        	data: pointArray
        }); //Variable heatmap (carte de chaleur) qui prend comme données les coordonnées lat et lng

        heatmap.setMap(map);
     	
        getLegende(); //On exécute la fonction getLegende où l'on créer les carrés de couleur et le texte
       // cliquer();
	   //filtrage();
	  });
    </script>
  </head>
  <body>
 	<big><b>Age des logements à la ville du Havre</b><br><br>
    <div id="map_canvas" class="bas"></div><br>
    <div id="legendeCarto" onclick="alert('test de clic sur la légende');"></div><br>
  </body>
</html>

