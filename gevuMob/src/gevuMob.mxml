<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark" applicationDPI="160">
	<fx:Script>
		<![CDATA[
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			
			import cpnt.alert;
			
			import views.html;
			
			protected function syncBase_clickHandler(event:MouseEvent):void
			{
				roMig.migreRefServeurToLocal();
			}
			
			protected function migreRefServeurToLocal_resultHandler(event:ResultEvent):void
			{
				var vHtml:html = rightNav.activeView as html;
				vHtml.chargeHtml(event.result as String);
			}
			private function faultHandlerService(fault:FaultEvent, os:String=""):void {
				var str:String;
				str = "Code: "+fault.fault.faultCode.toString()+"\n"+
					"Detail: "+fault.fault.faultDetail.toString()+"\n"+
					"String: "+fault.fault.faultString.toString()+"\n";
				
				if (os!="")
					os = " - "+os;
				var a:alert = new alert;
				a.mess = str;
				if(os)a.titre = os;
				a.open(this, false);
			}
			
		]]>
	</fx:Script>
	<fx:Declarations>
		<s:RemoteObject id="roMig"
						destination="zend"
						source="GEVU_Migration"
						fault="faultHandlerService(event, 'GEVU - Synchronisation');"
						showBusyCursor="true"
						>
			<s:method name="migreRefServeurToLocal" result="migreRefServeurToLocal_resultHandler(event)"/>
		</s:RemoteObject>
	</fx:Declarations>
		<fx:Style>
		@namespace s "library://ns.adobe.com/flex/spark";
		s|SpinnerList {
			textAlign: right;
			fontSize: 10;
			fontWeight: bold;
			color: red;
		}
		s|SpinnerListItemRenderer {
			paddingTop: 5;
			paddingBottom: 5;
			paddingRight: 5;
		}
	</fx:Style>
	<s:VGroup width="100%" height="100%" paddingBottom="2" paddingLeft="2" paddingRight="2" paddingTop="2" >
		<s:Button label="Synchroniser la base" click="syncBase_clickHandler(event)" />
		<s:SplitViewNavigator id="svn" width="100%" height="100%">
			<s:ViewNavigator id="leftNav" width="50%" height="100%" firstView="views.listeLieux"/>
			<s:ViewNavigator id="rightNav" width="50%" height="100%" firstView="views.html"/>
		</s:SplitViewNavigator>		
	</s:VGroup>

</s:Application>
